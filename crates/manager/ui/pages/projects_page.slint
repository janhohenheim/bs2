import {
    Button,
    GroupBox,
    SpinBox,
    ComboBox,
    CheckBox,
    LineEdit,
    TabWidget,
    VerticalBox,
    HorizontalBox,
    Slider,
    ProgressIndicator,
    SpinBox,
    Switch,
    Spinner,
    GridBox,
    TimePickerPopup,
    DatePickerPopup,
    Palette,
    ListView,
} from "std-widgets.slint";
import { Page } from "page.slint";
import { ProjectsPageLogic, ProjectDef } from "../globals.slint";


export component ProjectsPage inherits Page {
    title: @tr("Projects");
    description: @tr("This page gives an overview of the default widget set provided by Slint. The widgets are available in different styles native, fluent-(dark/light) and material-(dark/light). The widgets can be imported from \"std-widgets.slint\".");

    VerticalBox {
        alignment: start;
        Text {
            text: "Manage your projects and launch the Source 2 Tools. If you need help setting up the Bevy side of things, see the guide.";
        }

        GroupBox {
            title: "New Project";
            VerticalBox {
                alignment: start;
                GridLayout {
                    Row {
                        Text {
                            text: "Directory:";
                            vertical-alignment: center;
                            horizontal-alignment: right;
                        }

                        Rectangle {
                            background: Palette.background;
                            HorizontalLayout {
                                LineEdit {
                                    text: ProjectsPageLogic.new-project.path;
                                    placeholder-text: "Path to the project root containing Cargo.toml";
                                    accepted => {
                                    }
                                    changed text => {
                                        ProjectsPageLogic.new-project.path = self.text;
                                    }
                                    horizontal_stretch: 1;
                                }

                                Button {
                                    text: "ðŸ“‚";
                                    clicked => {
                                        let path = ProjectsPageLogic.pick-project();
                                        if path != "" {
                                            ProjectsPageLogic.new-project.path = path;
                                        }
                                    }
                                }
                            }
                        }
                    }

                    Row {
                        Text {
                            text: "Name:";
                            vertical-alignment: center;
                            horizontal-alignment: right;
                        }

                        Rectangle {
                            background: Palette.background;
                            HorizontalLayout {
                                LineEdit {
                                    text: ProjectsPageLogic.new-project.name;
                                    placeholder-text: "project_name";
                                    accepted => {
                                    }
                                    changed text => {
                                        ProjectsPageLogic.new-project.name = self.text;
                                    }
                                    horizontal_stretch: 1;
                                }
                            }
                        }
                    }
                }

                Button {
                    text: "+";
                    clicked => {
                    }
                }
            }
        }

        Text {
            text: "Launch existing projects";
        }

        VerticalBox {
            ListView {
                for project in ProjectsPageLogic.projects: Rectangle {
                    width: parent.width;
                    HorizontalBox {
                        alignment: start;
                        Text {
                            text: project.name;
                            horizontal-alignment: right;
                            vertical-alignment: center;
                        }

                        Rectangle {
                            background: gray;
                            width: 100px;
                            text := Text {
                                width: parent.width;
                                text: project.path;
                            }
                        }

                        Rectangle {
                            Button {
                                text: "Launch";
                            }
                        }
                    }
                }
            }
        }
    }

    Rectangle { }
}
